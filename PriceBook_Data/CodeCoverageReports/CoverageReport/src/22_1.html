<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\PriceBook\PriceBook_Data\Unit.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System.ComponentModel.DataAnnotations;
using System.Text;
using Microsoft.EntityFrameworkCore;

namespace PriceBook_Data
{
    public class Unit
    {

        public int Id { get; set; }

        
        public int UnitTypeId { get; set; }


        public UnitType UnitType { get; set; }

        [MaxLength(20)]
        public string Name { get; set; }


        public bool DefaultForType { get; set; }

        public Unit()
        {

        }

        public Unit(string name)
        {
            using (ApplicationContext context = new ApplicationContext())
            {
                Unit unit = context.Unit.FirstOrDefault(n =&gt; n.Name == name);
                UnitType unitType = new UnitType(unit.UnitTypeId);

                this.UnitType = unitType;
                this.Id = unit.Id;
                this.UnitTypeId = unit.UnitTypeId;
                this.DefaultForType = unit.DefaultForType;
                this.Name = unit.Name;
            }


        }

        public Unit(int id)
        {
            using (ApplicationContext context = new ApplicationContext())
            {

                Unit unit = context.Unit.Find(id);
                UnitType unitType = context.UnitType.Find(unit.UnitTypeId);

                this.UnitType = unitType;
                this.Id = id;
                this.UnitTypeId = unit.UnitTypeId;
                this.DefaultForType = unit.DefaultForType;
                this.Name = unit.Name;


            }
        }

        public void Add()
        {
            using ApplicationContext context = new ApplicationContext();
            context.Entry(UnitType).State = EntityState.Unchanged;
            context.Unit.Add(this);
            context.SaveChanges();
        }

        public void SaveUpdate()
        {

            using (ApplicationContext context = new ApplicationContext())
            {
                context.Unit.Attach(this);
                context.Entry(this).State = EntityState.Modified;
                context.SaveChanges();
            }

        }

        public void Delete()
        {
            using (ApplicationContext context = new ApplicationContext())
            {
                context.Unit.Attach(this);
                context.Unit.Remove(this);
                context.SaveChanges();
            }
        }

        public override string ToString()
        {
            StringBuilder builder = new StringBuilder();
            builder.AppendLine(&quot;Id: &quot; + Id);
            builder.AppendLine(&quot;Name: &quot; + Name);
            builder.AppendLine(&quot;Default for type: &quot; + DefaultForType);
            builder.AppendLine(&quot;Unit type:&quot; + UnitType.Name);

            return builder.ToString();
        }

        public bool Equals(Unit compare)
        {
            if (this.DefaultForType != compare.DefaultForType) return false;
            if (this.Id != compare.Id) return false;
            if (this.Name != compare.Name) return false;
            if (this.UnitTypeId != compare.UnitTypeId) return false;
            return true;
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[10,25,10,29,1],[10,30,10,34,1],[13,33,13,37,1],[13,38,13,42,1],[16,36,16,40,1],[16,41,16,45,1],[19,30,19,34,1],[19,35,19,39,1],[22,38,22,42,1],[22,43,22,47,1],[24,9,24,22,1],[25,9,25,10,1],[27,9,27,10,1],[29,9,29,33,1],[30,9,30,10,1],[31,20,31,73,1],[32,13,32,14,1],[33,17,33,78,1],[34,17,34,67,1],[36,17,36,42,1],[37,17,37,35,1],[38,17,38,51,1],[39,17,39,59,1],[40,17,40,39,1],[41,13,41,14,1],[44,9,44,10,1],[46,9,46,28,1],[47,9,47,10,1],[48,20,48,73,1],[49,13,49,14,1],[51,17,51,51,1],[52,17,52,76,1],[54,17,54,42,1],[55,17,55,30,1],[56,17,56,51,1],[57,17,57,59,1],[58,17,58,39,1],[61,13,61,14,1],[62,9,62,10,1],[65,9,65,10,1],[66,13,66,73,1],[67,13,67,67,1],[68,13,68,36,1],[69,13,69,35,1],[70,9,70,10,1],[73,9,73,10,1],[75,20,75,73,1],[76,13,76,14,1],[77,17,77,43,1],[78,17,78,66,1],[79,17,79,39,1],[80,13,80,14,1],[82,9,82,10,1],[85,9,85,10,1],[86,20,86,73,1],[87,13,87,14,1],[88,17,88,43,1],[89,17,89,43,1],[90,17,90,39,1],[91,13,91,14,1],[92,9,92,10,1],[95,9,95,10,1],[96,13,96,57,1],[97,13,97,45,1],[98,13,98,49,1],[99,13,99,71,1],[100,13,100,62,1],[102,13,102,39,1],[103,9,103,10,1],[106,9,106,10,1],[107,13,107,63,1],[107,64,107,77,1],[108,13,108,39,1],[108,40,108,53,1],[109,13,109,43,1],[109,44,109,57,1],[110,13,110,55,1],[110,56,110,69,1],[111,13,111,25,1],[112,9,112,10,1]]);
    </script>
  </body>
</html>